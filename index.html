<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Formulario de Obra</title>
  <!-- SDK de Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body>

<h2>Registro de Obra</h2>

<form id="formulario">
  <label>Nombre:</label><br>
  <input type="text" name="nombre" required><br><br>

  <label>Email:</label><br>
  <input type="email" name="email" required><br><br>

  <label>Mensaje:</label><br>
  <textarea name="mensaje" required></textarea><br><br>

  <button type="submit">Enviar</button>
</form>

<script>
  // -----------------------------
  // 1. Configuración de Firebase
  // -----------------------------
  const firebaseConfig = {
    apiKey: "AIzaSyBlRbAQZVSWSZgNw8w4Iie7WsdSdogRX5o",
    authDomain: "formularioobra.firebaseapp.com",
    projectId: "formularioobra",
    storageBucket: "formularioobra.firebasestorage.app",
    messagingSenderId: "483554481916",
    appId: "1:483554481916:web:c2b175955247a1b6f56979"
  };

  // Inicializar Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // -----------------------------
  // 2. Manejar el envío del formulario
  // -----------------------------
  const formulario = document.getElementById('formulario');
  formulario.addEventListener('submit', function(e) {
    e.preventDefault(); // Evita que la página se recargue

    const nombre = formulario.nombre.value;
    const email = formulario.email.value;
    const mensaje = formulario.mensaje.value;

    // Guardar en Firestore
    db.collection("registros").add({
      nombre: nombre,
      email: email,
      mensaje: mensaje,
      fecha: new Date()
    })
    .then(() => {
      alert("¡Registro enviado correctamente!");
      formulario.reset(); // Limpia el formulario
    })
    .catch((error) => {
      alert("Error al enviar: " + error);
    });
  });
</script>

</body>
</html>
